<?xml version="1.0" encoding="UTF-8"?>
<RuleSet
  name="MolsaRelationshipSummaryRuleSet"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="http://www.curamsoftware.com/CreoleRulesSchema.xsd"
>

  <Class
    extends="DefaultEvidenceSummary"
    extendsRuleSet="EvidenceSummaryRuleSet"
    name="MolsaRelationshipSummary"
  >

    <Attribute  name="evidence"
    >
      <type>
        <ruleclass
          name="MolsaRelationship"
          ruleset="MolsaRelationshipRuleSet"
        />
      </type>
      <derivation>
        <specified/>
      </derivation>
    </Attribute>
    
    <Attribute
      name="summary"
    >
      <type>
        <javaclass
          name="curam.creole.value.Message"
        />
      </type>
      <derivation>
        <ResourceMessage
          key="summaryMessage1"
          resourceBundle="curam.evidence.MolsaRelationshipSummaryRuleSet"
        >
          <reference
            attribute="relationshipType"
          >
            <reference
              attribute="evidence"
            />
          </reference>
         
          <reference
            attribute="concernRoleName"
          >
            <reference
              attribute="relatedConcernRole"
            />
          </reference>
           <reference
            attribute="concernRoleName"
          >
            <reference
              attribute="concernRole"
            />
          </reference>
        </ResourceMessage>
      </derivation>
    </Attribute>
    
    
    <Attribute
      name="concernRole"
    >
      <type>
        <ruleclass
          name="ConcernRole"
          ruleset="ParticipantEntitiesRuleSet"
        />
      </type>
      <derivation>
        <singleitem
          onEmpty="error"
          onMultiple="error"
        >
          <readall
            ruleclass="ConcernRole"
            ruleset="ParticipantEntitiesRuleSet"
          >
            <match
              retrievedattribute="concernRoleID"
            >
              <reference
                attribute="participantRoleID"
              >
                <reference
                  attribute="related_participant"
                >
                  <reference
                    attribute="evidence"
                  />
                </reference>
              </reference>
            </match>
          </readall>
        </singleitem>
      </derivation>
    </Attribute>
    
    
    <Attribute
      name="relatedConcernRole"
    >
      <type>
        <ruleclass
          name="ConcernRole"
          ruleset="ParticipantEntitiesRuleSet"
        />
      </type>
      <derivation>
        <singleitem
          onEmpty="error"
          onMultiple="error"
        >
          <readall
            ruleclass="ConcernRole"
            ruleset="ParticipantEntitiesRuleSet"
          >
            <match
              retrievedattribute="concernRoleID"
            >
              <reference
                attribute="participantRoleID"
              >
                <reference
                  attribute="related_relatedParticipant"
                >
                  <reference
                    attribute="evidence"
                  />
                </reference>
              </reference>
            </match>
          </readall>
        </singleitem>
      </derivation>
    </Attribute>
  </Class>
</RuleSet>
