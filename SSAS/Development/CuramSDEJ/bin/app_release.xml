<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed Materials - Property of IBM

  Copyright IBM Corporation 2012. All Rights Reserved.

  US Government Users Restricted Rights - Use, duplication or disclosure
  restricted by GSA ADP Schedule Contract with IBM Corp.
-->
<!--

  This is the ant file used to gather files for a release.

-->
<project name="app_release" default="main">

  <!--  ***************************  -->
  <!--  ***  Import Properties  ***  -->
  <!--  ***************************  -->
  <import file="./app_properties.xml" />

  <!--  **************************  -->
  <!--  ***  Import Utilities  ***  -->
  <!--  **************************  -->
  <import file="./app_utilities.xml" />

  <!--  ***********************  -->
  <!--  ***  R E L E A S E  ***  -->
  <!--  ***********************  -->
  <target name="main" description="Gather release files">

    <antcall target="dispmsg"><param name="prm.msg" value="Building release"/></antcall>

    <delete dir="${dir.release}" />
    <mkdir dir="${dir.release}" />

    <!-- Copy Data Manager files -->
    <copy todir="${dir.release}/components" includeEmptyDirs="false">
      <fileset dir="${dir.base.components}" >
        <include name="*/Data_Manager/**" />
        <include name="*/data/**"/>
        <include name="*/rulesets/**" />
        <include name="*/batch/**" />
        <include name="*/ieg/**" />
        <include name="*/lib/**" />
        <include name="*/properties/**" />
        <include name="*/userpreferences/**" />
        <include name="*/tab/**" />
        <include name="*/clientapps/**" />
        <exclude name="**/CVS/*" />
        <exclude name="**/TestData/**" />
      </fileset>
    </copy>

    <!-- Copy Data Manager Config file -->
    <copy todir="${dir.release}/project/config" includeEmptyDirs="false" >
      <fileset dir="${dir.project.config}" >
        <exclude name="**/CVS/*" />
      </fileset>
    </copy>

    <!-- Copy Application property files -->
    <copy todir="${dir.release}/project/properties" includeEmptyDirs="false" >
      <fileset dir="${dir.project.properties}" casesensitive="false">
        <exclude name="**/CVS/*" />
        <exclude name="Bootstrap.properties" />
        <exclude name="AppServer.properties" />
      </fileset>
    </copy>

    <!-- Copy Application DDL Files -->
    <copy todir="${dir.release}/build/ddl" >
      <fileset dir="${dir.bld}/ddl" >
        <exclude name="**/CVS/*" />
      </fileset>
    </copy>
    <copy todir="${dir.release}/build/svr/gen/ddl" >
      <fileset dir="${dir.bld.svr.gen}/ddl" >
        <exclude name="**/CVS/*" />
      </fileset>
    </copy>

    <!-- Copy Application Jar Files -->
    <copy todir="${dir.release}/build/jar" >
      <fileset dir="${dir.bld.jar}" >
        <exclude name="**/CVS/*" />
        <exclude name="*_src.zip" />
      </fileset>
    </copy>

    <!-- Copy Application CodeTables -->
    <copy todir="${dir.release}/build/svr/codetable/sql" >
      <fileset dir="${dir.bld.svr.ctx.sql}" >
        <include name="**/*.sql" />
        <exclude name="**/CVS/*" />
      </fileset>
    </copy>

    <!-- Copy Application Events -->
    <copy todir="${dir.release}/build/svr/events/gen" >
      <fileset dir="${j.gen.events}" >
        <include name="**/*.dmx" />
        <exclude name="**/CVS/*" />
      </fileset>
    </copy>

    <!-- Copy SDEJ ant files necessary -->
    <copy todir="${dir.release}/CuramSDEJ/bin" includeEmptyDirs="false" >
      <fileset dir="${dir.sde.bin}" >
        <exclude name="**/CVS/*" />
      </fileset>
    </copy>

    <!-- Copy SDEJ libraries necessary -->
    <copy todir="${dir.release}/CuramSDEJ/lib" includeEmptyDirs="false" >
      <fileset dir="${dir.sde.lib}" casesensitive="false">
        <exclude name="**/CVS/*" />
      </fileset>
    </copy>

    <!-- Copy SDEJ scripts necessary for the Data Manager -->
    <copy todir="${dir.release}/CuramSDEJ/scripts" includeEmptyDirs="false" >
      <fileset dir="${dir.sde.scripts}" >
        <exclude name="**/CVS/*" />
      </fileset>
    </copy>

    <copy todir="${dir.release}/CuramSDEJ/drivers" includeEmptyDirs="false" >
      <fileset dir="${dir.sde.drivers}" >
        <exclude name="**/CVS/*" />
      </fileset>
    </copy>

    <copy todir="${dir.release}/CuramSDEJ/util" includeEmptyDirs="false" >
      <fileset dir="${dir.sde}/util" >
        <exclude name="**/CVS/*" />
      </fileset>
    </copy>

   <!-- Copy built Application and WebServices EAR file -->
    <copy todir="${dir.release}/ear" >
      <fileset dir="${dir.ear}" >
        <include name="**/*.ear" />
      </fileset>
    </copy>

   <!-- Copy SDEJ XML Server file -->
     <copy todir="${dir.release}/CuramSDEJ/xmlserver" >
        <fileset dir="${dir.sde.xmlserver}" >
          <exclude name="**/CVS/*" />
        </fileset>
     </copy>

   <!-- Copy SDEJ batch and build files -->
     <copy todir="${dir.release}" >
       <fileset dir="${base.dir}" >
          <include name="build.bat" />
          <include name="build.sh" />
          <include name="build.xml" />
       </fileset>
     </copy>

  </target>

</project>

