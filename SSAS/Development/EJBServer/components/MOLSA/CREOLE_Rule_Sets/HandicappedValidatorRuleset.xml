<?xml version="1.0" encoding="UTF-8"?>

<RuleSet xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="file:///D:/IBM/Catalog/RuleSet.xsd"
	name="HandicappedValidatorRuleset">


	<Class extends="DefaultEvidenceValidationResult" extendsRuleSet="EvidenceValidationRuleSet"
		name="HandicappedValidatorResult">


		<Attribute name="evidence">
			<type>
				<ruleclass name="UnableToWork" ruleset="UnableToWorkRuleSet" />
			</type>
			<derivation>
				<specified />
			</derivation>
		</Attribute>


		<Attribute name="standardValidations">
			<type>
				<javaclass name="java.util.List">
					<ruleclass name="Validation" ruleset="EvidenceValidationRuleSet" />
				</javaclass>
			</type>
			<derivation>
				<fixedlist>
					<listof>
						<ruleclass name="Validation" ruleset="EvidenceValidationRuleSet" />
					</listof>
					<members>
						<reference attribute="endDateDOBValidation" />
					</members>
				</fixedlist>
			</derivation>
		</Attribute>




		<Attribute name="endDateDOBValidation">
			<type>
				<ruleclass name="Validation" ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation" ruleset="EvidenceValidationRuleSet">
					<reference attribute="validationRequired" />
					<reference attribute="validationMessage" />
				</create>
			</derivation>
		</Attribute>

		<Attribute name="validationRequired">
			<type>
				<javaclass name="Boolean" />
			</type>
			<derivation>
				<any>
					<fixedlist>
						<listof>
							<javaclass name="Boolean"></javaclass>
						</listof>
						<members>
							<reference attribute="endDateOrPConditionRequired" />
							<reference attribute="endDateFailure" />
						</members>
					</fixedlist>
				</any>
			</derivation>
		</Attribute>

		<Attribute name="validationMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<choose>
					<type>
						<javaclass name="curam.creole.value.Message" />
					</type>
					<when>
						<condition>
							<reference attribute="endDateOrPConditionRequired"></reference>
						</condition>
						<value>
							<ResourceMessage key="ERR_ENDDATE_OR_PCONDITION"
								resourceBundle="curam.evidence.HandicappedValidatorRuleset">
							</ResourceMessage>
						</value>
					</when>
					<otherwise>
						<value>
							<ResourceMessage key="ERR_HANDICAPPED_DATE"
								resourceBundle="curam.evidence.HandicappedValidatorRuleset">
							</ResourceMessage>
						</value>
					</otherwise>
				</choose>
			</derivation>
		</Attribute>


		<Attribute name="endDateOrPConditionRequired">
			<type>
				<javaclass name="Boolean" />
			</type>
			<derivation>
				<all>
					<fixedlist>
						<listof>
							<javaclass name="Boolean" />
						</listof>
						<members>
							<not>
								<reference attribute="permanentCondition">
									<reference attribute="evidence" />
								</reference>
							</not>
							<equals>
								<reference attribute="endDate">
									<reference attribute="evidence" />
								</reference>
								<null />
							</equals>
						</members>
					</fixedlist>
				</all>
			</derivation>
		</Attribute>


		<Attribute name="endDateFailure">
			<type>
				<javaclass name="Boolean" />
			</type>
			<derivation>
				<choose>
					<type>
						<javaclass name="Boolean" />
					</type>
					<when>
						<condition>
							<all>
								<fixedlist>
									<listof>
										<javaclass name="Boolean" />
									</listof>
									<members>
										<not>
											<reference attribute="permanentCondition">
												<reference attribute="evidence" />
											</reference>
										</not>
										<not>
											<equals>
												<reference attribute="endDate">
													<reference attribute="evidence" />
												</reference>
												<null />
											</equals>
										</not>
										<compare comparison="&gt;">
											<reference attribute="endDate">
												<reference attribute="evidence" />
											</reference>
											<call class="curam.socialassistance.creole.statics.impl.Statics"
												method="shiftDateByYears">
												<type>
													<javaclass name="curam.util.type.Date" />
												</type>
												<arguments>
													<reference attribute="startDate">
														<reference attribute="evidence" />
													</reference>
													<Number value="2" />
													<false />
												</arguments>
											</call>
										</compare>
									</members>
								</fixedlist>
							</all>
						</condition>
						<value>
							<true />
						</value>
					</when>
					<otherwise>
						<value>
							<false />
						</value>
					</otherwise>
				</choose>
			</derivation>
		</Attribute>


	</Class>
</RuleSet>
