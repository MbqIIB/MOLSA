
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link href="../css/style.css" TYPE="text/css" REL="stylesheet" media="screen">
<link href="../css/print_style.css" type="text/css" rel="stylesheet" media="print">
</head>
<script language="javascript" src="../js/tabletoggle.js"></script>
<body>

<div class="menu">
<a href="../index.html">Home</a> | <a href="staging-index.html">Staging Area Tables</a> | <a href="warehouse-index.html">Warehouse Tables</a> | <a href="datamart-index.html">Datamart Tables</a> | <a href="inf-index.html">Infrastructure Tables</a>
</div>
<hr>
<table width="100%">
<tr width="100%">
<td colspan="1" align="left" valign="top"><h2>IBM C&#250;ram Business Intelligence and Analytics</h2></td><td align="right" valign="top"><img  src="../images/ibmlogo.png"></td>
</tr>
</table>

<hr>
<h2>Database View: <i>DM_VW_MEDICAIDELIGIBLES</i>
</h2>
<table class="cbb" cellspacing="0">
<colgroup span="2">
<col width="25%">
<col width="75%">
</colgroup>
<thead>
<tr>
<td colspan="1" class="collapse">View Details</td><td class="collapseImg"><img src="../images/collapse.bmp" onclick="javascript:Toggle('OpDtls');" id="iconOpDtls"></td>
</tr>
</thead>
<tbody id="tableBodyOpDtls">
<tr>
<td class="label">Description: </td><td class="value">
<b>DM_VW_MEDICAIDELIGIBLES
:</b>
<i> dm_vw_medicaideligibles
</i>
<p><b>Description:</b></p>
<P> </P>

<p><b>Example:</b></p>
<P>
     
</P>

<p><b>Technical Notes:</b></p>

<P>

 

</p>
</td>
</tr>

</tbody>
</table>
<br>
<table  class="cbb" cellspacing="0">

<thead>
<tr >
<td colspan="1" class="collapse">SQL</td><td class="collapseImg"><img src="../images/collapse.bmp" onclick="javascript:Toggle('Sql');" id="iconSql"></td>
</tr>
</thead>
<tbody id="tableBodySql">
<tr >
<td class="singleValue" colspan="1" >
<pre>
select sum(Medic) as Medic, sum (food) as Food, sum (Cash) as Cash, sum (All_Programs) as All_Programs, FEDERALFISCALYEAR from
(select count(distinct a.concernroleid) as Medic, 0 as Food, 0 as Cash, 0 as All_Programs, c.FEDERALFISCALYEAR
from DM_FACTPRODUCTAWARDRECIPIENT a
inner join DM_DIMPROGRAM  b on a.DIMPROGRAMKEY = b.DIMPROGRAMKEY
inner join dm_dimtimeperiod c on a.startdatekey = c.timeperiodkey
where b.PROGRAMCODE = 'PT100'
group by 2,3,4,FEDERALFISCALYEAR

UNION ALL

select 0 as Medic, count(distinct a.concernroleid) as Food, 0 as Cash, 0 as All_Programs, e.FEDERALFISCALYEAR
from DM_FACTPRODUCTAWARDRECIPIENT a
inner join DM_DIMPROGRAM  b on a.DIMPROGRAMKEY = b.DIMPROGRAMKEY
inner join DM_DIMTIMEPERIOD e on a.startdatekey = e.timeperiodkey
where b.PROGRAM = 'FoodStamp' and concernroleid in 
	(select concernroleid 
	from DM_FACTPRODUCTAWARDRECIPIENT a
	inner join DM_DIMPROGRAM  b on a.DIMPROGRAMKEY = b.DIMPROGRAMKEY
	inner join DM_DIMTIMEPERIOD e on a.startdatekey = e.timeperiodkey
	where b.PROGRAMCODE = 'PT100')
group by 1,3,4,FEDERALFISCALYEAR

UNION ALL

select 0 as Medic, 0 as Food, count(distinct a.concernroleid) as Cash, 0 as All_Programs, e.FEDERALFISCALYEAR
from DM_FACTPRODUCTAWARDRECIPIENT a
inner join DM_DIMPROGRAM  b on a.DIMPROGRAMKEY = b.DIMPROGRAMKEY
inner join DM_DIMTIMEPERIOD e on a.startdatekey = e.timeperiodkey
where b.PROGRAM = 'Cash Assistance' and concernroleid in 
	(select concernroleid 
	from DM_FACTPRODUCTAWARDRECIPIENT a
	inner join DM_DIMPROGRAM  b on a.DIMPROGRAMKEY = b.DIMPROGRAMKEY
	inner join DM_DIMTIMEPERIOD e on a.startdatekey = e.timeperiodkey
	where b.PROGRAMCODE = 'PT100')
group by 1,3,4,FEDERALFISCALYEAR

UNION ALL

select 0 as Medic, 0 as Food, 0 as Cash, count(distinct a.concernroleid) as All_Programs, e.FEDERALFISCALYEAR
from DM_FACTPRODUCTAWARDRECIPIENT a
inner join DM_DIMPROGRAM d on a.DIMPROGRAMKEY = d.DIMPROGRAMKEY and d.PROGRAMCODE = 'PT100'
inner join DM_DIMTIMEPERIOD e on a.startdatekey = e.timeperiodkey
inner join DM_FACTPRODUCTAWARDRECIPIENT b on a.concernroleid = b.concernroleid and b.startdatekey = e.timeperiodkey
inner join DM_DIMPROGRAM f on b.DIMPROGRAMKEY = f.DIMPROGRAMKEY and f.PROGRAM = 'FoodStamp'
inner join DM_FACTPRODUCTAWARDRECIPIENT c on a.concernroleid = c.concernroleid and c.startdatekey = e.timeperiodkey
inner join DM_DIMPROGRAM g on c.DIMPROGRAMKEY = g.DIMPROGRAMKEY and g.PROGRAM = 'Cash Assistance'
group by 1,2,3,FEDERALFISCALYEAR
) query
Group by FEDERALFISCALYEAR;
</pre>
</td>
</tr>
</tbody>
</table>
<hr>
<div>

<div class="menu">
<a href="index.html">Home</a> | <a href="entities/staging-index.html">Staging Area Tables</a> | <a href="entities/warehouse-index.html">Warehouse Tables</a> | <a href="entities/datamart-index.html">Datamart Tables</a> | <a href="entities/inf-index.html">Infrastructure Tables</a>
</div>
<!--<div class="generated">Generated on 2013-Jan-28-10.00.27.250 <i>Version 6.0.5.0 </i>.-->
</div>
</body>
</html>
